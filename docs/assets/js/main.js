"use strict";const inputEl=document.querySelector(".app-input"),btnEl=document.querySelector(".btn"),resultListEl=document.querySelector(".results__list"),favouritesListEl=document.querySelector(".favourites__list");let resultsArr=[],myFavShowsArr=[];const favShowsObjectsArray=[];function createItemsFromSearch(e){resultsArr=[];for(const t of e){const e=t.show.name;let r="";r=t.show.image?t.show.image.medium:`https://via.placeholder.com/210x295/f4eded/9b1414/?text=${e}`;const s=document.createElement("li"),o=document.createElement("img");o.setAttribute("src",r),o.setAttribute("alt",e);const n=document.createElement("h3"),c=document.createTextNode(e);n.appendChild(c),s.setAttribute("id",e),s.appendChild(o),s.appendChild(n),resultsArr.push(s)}return resultsArr}function appendClass(e,t){for(const r of e)r.classList.add(t);return e}function paintResults(e,t){t.innerHTML="";for(const r of e)t.appendChild(r)}function storeArrInObject(e){for(let t=0;t<e.length;t++){const r=e[t].firstElementChild.src,s=e[t].lastElementChild.innerHTML;favShowsObjectsArray[t]={url:r,title:s}}}function createItemsFromObjArr(e){const t=[];for(const r of e){const e=r.title,s=r.url,o=document.createElement("li"),n=document.createElement("img");n.setAttribute("src",s),n.setAttribute("alt",e);const c=document.createElement("h3"),a=document.createTextNode(e);c.appendChild(a),o.appendChild(n),o.appendChild(c),o.classList.add("preview--favourite"),t.push(o)}return t}function storeInLS(e,t){localStorage.setItem(e,JSON.stringify(t))}function refreshPage(){const e=JSON.parse(localStorage.getItem("myObject"));if(e){console.log("caché has something",e);const t=createItemsFromObjArr(e);console.log("savedItemToPaint",t),myFavShowsArr=t,paintResults(t,favouritesListEl)}else console.log("caché is empty")}function handlerCardsFavClick(e){const t=e.currentTarget;if(!t.classList.contains("show-card--favourite")){t.classList.add("show-card--favourite"),myFavShowsArr.push(t),console.log("myFavShowsArr",myFavShowsArr),storeArrInObject(myFavShowsArr),console.log("favShowsObjectsArray",favShowsObjectsArray);const e=createItemsFromObjArr(favShowsObjectsArray);console.log("newItemToPaint",e),paintResults(e,favouritesListEl),storeInLS("myObject",favShowsObjectsArray)}}function handlerBtnSearch(){const e=inputEl.value;fetch(`http://api.tvmaze.com/search/shows?q=${e}`).then(function(e){return e.json()}).then(function(e){return e}).then(function(e){paintResults(appendClass(createItemsFromSearch(e),"show-card"),resultListEl);const t=document.querySelectorAll(".show-card");for(const e of t)e.addEventListener("click",handlerCardsFavClick)})}btnEl.addEventListener("click",handlerBtnSearch),refreshPage();