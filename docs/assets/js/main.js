"use strict";const inputEl=document.querySelector(".app-input"),btnEl=document.querySelector(".btn"),resultListEl=document.querySelector(".results__list"),favouritesListEl=document.querySelector(".favourites__list");let resultsArr=[],myFavShowsArr=[];const favShowsObjectsArray=[];function createItemsFromSearch(e){resultsArr=[];for(const t of e){const e=t.show.id,o=t.show.name;let r="";r=t.show.image?t.show.image.medium:`https://via.placeholder.com/210x295/f4eded/9b1414/?text=${o}`;const n=document.createElement("li"),s=document.createElement("img");s.setAttribute("src",r),s.setAttribute("alt",o);const c=document.createElement("h3"),a=document.createTextNode(o);c.appendChild(a),n.setAttribute("id",e),n.appendChild(s),n.appendChild(c),resultsArr.push(n)}return resultsArr}function appendClass(e,t){for(const o of e)o.classList.add(t);return e}function paintResults(e,t){t.innerHTML="";for(const o of e)t.appendChild(o)}function storeArrInObject(e){for(let t=0;t<e.length;t++){const o=e[t].firstElementChild,r=o.src,n=o.nextElementSibling;console.log(n);const s=n.innerHTML;console.log(s),favShowsObjectsArray[t]={url:r,title:s}}}function createItemsFromObjArr(e){const t=[];for(const o of e){const e=o.title,r=o.url,n=document.createElement("li"),s=document.createElement("img");s.setAttribute("src",r),s.setAttribute("alt",e);const c=document.createElement("h3"),a=document.createTextNode(e);c.appendChild(a),n.appendChild(s),n.appendChild(c),n.classList.add("preview--favourite"),addResetBtn(e,n),t.push(n)}return console.log(t),t}function storeInLS(e,t){localStorage.setItem(e,JSON.stringify(t))}function refreshPage(){const e=JSON.parse(localStorage.getItem("myObject"));if(e){console.log("caché has something",e);const t=createItemsFromObjArr(e);console.log("savedItemToPaint",t),myFavShowsArr=t,paintResults(t,favouritesListEl)}else console.log("caché is empty")}function handlerResetBtnClick(e){const t=e.currentTarget.parentNode;console.log(t)}function addResetBtn(e,t){const o=document.createElement("button");o.classList.add("reset-btn");const r=document.createTextNode("x");o.appendChild(r),o.setAttribute("data--id",e),t.appendChild(o),o.addEventListener("click",handlerResetBtnClick)}function handlerCardsFavClick(e){const t=e.currentTarget,o=t.id;console.log(o),console.log(myFavShowsArr);for(const e of myFavShowsArr){if(console.log(myFavShowsArr),o===e.id)return void console.log("id repetido");console.log("id nuevo")}t.classList.add("show-card--favourite"),myFavShowsArr.push(t),console.log("myFavShowsArr",myFavShowsArr),storeArrInObject(myFavShowsArr);const r=createItemsFromObjArr(favShowsObjectsArray);console.log("newArrayItemsToPaint",r),paintResults(r,favouritesListEl),storeInLS("myObject",favShowsObjectsArray)}function handlerBtnSearch(){const e=inputEl.value;fetch(`http://api.tvmaze.com/search/shows?q=${e}`).then(function(e){return e.json()}).then(function(e){return e}).then(function(e){paintResults(appendClass(createItemsFromSearch(e),"show-card"),resultListEl);const t=document.querySelectorAll(".show-card");for(const e of t)e.addEventListener("click",handlerCardsFavClick)})}btnEl.addEventListener("click",handlerBtnSearch),refreshPage();